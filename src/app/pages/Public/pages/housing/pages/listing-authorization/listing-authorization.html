<div class="authorization-container">
    <h2 class="page-title">Post Listing Authorization</h2>

    <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <!-- Section 1: Your Information -->
        <div class="auth-section bg-yellow">
            <div class="section-header">
                <div class="step-badge badge-yellow">1</div>
                <h3>Your Information</h3>
            </div>

            <div class="row">
                <div class="col-12 form-group-row">
                    <label>Full Name *</label>
                    <input type="text" class="form-control-custom" formControlName="FullName"
                        [class.is-invalid]="form.get('FullName')?.invalid && form.get('FullName')?.touched"
                        placeholder="Jane Doe">
                </div>
                <div class="col-12 form-group-row">
                    <label>Business/Organization Name</label>
                    <input type="text" class="form-control-custom" formControlName="OrganizationName"
                        placeholder="Jane Doe">
                </div>
                <div class="col-md-6 form-group-row">
                    <label>Email Address *</label>
                    <input type="email" class="form-control-custom" formControlName="Email"
                        [class.is-invalid]="form.get('Email')?.invalid && form.get('Email')?.touched"
                        placeholder="Jane@gmail.com">
                </div>
                <div class="col-md-6 form-group-row">
                    <label>Phone Number</label>
                    <input type="tel" class="form-control-custom" formControlName="PhoneNumber"
                        [class.is-invalid]="form.get('PhoneNumber')?.invalid && form.get('PhoneNumber')?.touched"
                        placeholder="(555) 000 - 0000">
                </div>
            </div>
        </div>

        <!-- Section 2: Preferred Availability Details -->
        <div class="auth-section bg-purple">
            <div class="section-header">
                <div class="step-badge badge-purple">2</div>
                <h3>Preferred Availability Details <span
                        style="font-size: 0.6em; font-weight: 500; margin-left: 5px;">(Multi-Selects)</span></h3>
            </div>

            <div class="row">
                <div class="col-md-6 form-group-row">
                    <label>Preferred Contact Date/s *</label>
                    <input type="date" class="form-control-custom" formControlName="PreferredContactDate"
                        [class.is-invalid]="form.get('PreferredContactDate')?.invalid && form.get('PreferredContactDate')?.touched"
                        placeholder="mm/dd/yyyy">
                </div>
                <div class="col-md-6 form-group-row">
                    <label>Preferred Contact Time *</label>
                    <input type="time" class="form-control-custom" formControlName="PreferredContactTime"
                        [class.is-invalid]="form.get('PreferredContactTime')?.invalid && form.get('PreferredContactTime')?.touched"
                        placeholder="Time">
                </div>

                <div class="col-md-6 form-group-row">
                    <label>Preferred Virtual Tours</label>
                    <input type="date" class="form-control-custom" formControlName="PreferredVirtualTourDate"
                        placeholder="mm/dd/yyyy">
                </div>
                <div class="col-md-6 form-group-row">
                    <label>Time Window</label>
                    <input type="time" class="form-control-custom" formControlName="PreferredVirtualTourTime"
                        placeholder="Time">
                </div>

                <div class="col-md-6 form-group-row">
                    <label>Preferred In-Person Tours</label>
                    <input type="date" class="form-control-custom" formControlName="PreferredInPersonTourDate"
                        placeholder="mm/dd/yyyy">
                </div>
                <div class="col-md-6 form-group-row">
                    <label>Time Window</label>
                    <input type="time" class="form-control-custom" formControlName="PreferredInPersonTourTime"
                        placeholder="Time Window">
                </div>
            </div>
        </div>

        <!-- Section 3: Upload Documents -->
        <div class="auth-section bg-blue">
            <div class="section-header">
                <div class="step-badge badge-blue">3</div>
                <h3>Upload One-time Authorization Documents</h3>
            </div>

            <div class="max-docs-badge">
                Max 1 Documents recommended
            </div>

            <div class="row">
                <!-- Left Column -->
                <div class="col-md-7 pe-md-4">
                    <div class="form-group-row">
                        <label>Authorization Type</label>
                        <select class="form-control-custom" formControlName="AuthorizationType">
                            <option [ngValue]="null">Select Authorization Type</option>
                            <option *ngFor="let type of authorizationTypes" [value]="type.id">{{type.name}}</option>
                        </select>
                        <div class="helper-text">Who is authorized to post this listing?</div>
                    </div>

                    <div class="row">
                        <div class="col-md-7 form-group-row">
                            <label>Listing Authorization Document(s)</label>
                            <select class="form-control-custom" formControlName="ListingAuthorizationDocument">
                                <option [ngValue]="null">Select Authorization Type</option>
                                <option *ngFor="let doc of documentTypes" [value]="doc.id">{{doc.name}}</option>
                            </select>
                            <div class="helper-text">Who is authorized to post this listing?</div>
                        </div>
                        <div class="col-md-5 form-group-row">
                            <label>Authorization Validation</label>
                            <input type="date" class="form-control-custom" formControlName="AuthorizationValidationDate"
                                placeholder="mm/dd/yyyy">
                            <div class="helper-text">Validation until</div>
                        </div>
                    </div>

                    <div class="mt-4">
                        <div class="description-block">
                            <h4>Individual Authorization</h4>
                            <p>For people acting in their own name (property owners, individual agents, or lease
                                holders).</p>
                        </div>
                        <div class="description-block">
                            <h4>Business Authorization</h4>
                            <p>For licensed real estate businesses such as agencies, brokerages, or property management
                                companies.</p>
                        </div>
                        <div class="description-block">
                            <h4>Organization Authorization</h4>
                            <p>For housing organizations, nonprofits, or mission-driven entities.</p>
                        </div>

                        <div class="d-flex align-items-center justify-content-between mt-4">
                            <div style="font-weight: 700; font-size: 0.95rem; color: #000;">Save this authorization for
                                future listings</div>
                            <div class="form-check form-switch ms-3">
                                <input class="form-check-input" type="checkbox" role="switch" id="authSwitch"
                                    formControlName="SaveThisAuthorizationForFutureListings">
                            </div>
                        </div>
                        <div class="helper-text-bold" style="margin-top: -5px;">Recommended for agents, brokers, and
                            organizations</div>
                    </div>
                </div>

                <!-- Right Column (Upload & Docs) -->
                <div class="col-md-5">
                    <!-- Dropzone -->
                    <div class="upload-wrapper" (click)="fileInput.click()">
                        <div class="upload-icon-circle">
                            <i class="bi bi-file-earmark-plus"></i>
                        </div>
                        <h4 *ngIf="selectedFiles.length === 0">Drag and drop Documents</h4>
                        <h4 *ngIf="selectedFiles.length > 0">{{selectedFiles.length}} Files Selected</h4>

                        <p>Supports Doc, Pdf, Max file<br>size 10MB per doc.</p>

                        <button type="button" class="btn-select-files">Select Files</button>
                        <input type="file" #fileInput multiple (change)="onFileSelect($event)" style="display: none;">
                    </div>

                    <div *ngIf="selectedFiles.length > 0" class="mb-3">
                        <div *ngFor="let file of selectedFiles; let i = index"
                            class="d-flex justify-content-between align-items-center p-2 bg-white rounded mb-1 shadow-sm">
                            <span class="small text-truncate text-dark" style="max-width: 85%;">{{file.name}}</span>
                            <i class="bi bi-x text-danger" (click)="removeFile(i); $event.stopPropagation()"
                                style="cursor: pointer;"></i>
                        </div>
                    </div>

                    <!-- Accepted Docs List -->
                    <div class="accepted-docs mt-3">
                        <h5>Accepted Documents</h5>
                        <ul>
                            <li *ngFor="let doc of documentTypes">{{doc.name}}</li>
                        </ul>
                    </div>
                </div>
            </div>

            <button type="button" class="add-section-btn">
                <span class="badge-number me-2" style="background:none; color:inherit; font-weight:800;">3.1</span>
                + Add a additional Authorization Documents
            </button>
        </div>

        <!-- Section 4 (Event) REMOVED as requested -->

        <!-- Footer -->
        <div class="footer-action">
            <div class="terms">
                Terms and conditions<br>
                <span>By clicking 'Post Listing', you agree to our Terms and Conditions and all applicable
                    Regulations.</span>
            </div>
            <button type="submit" class="btn-post-listing" [disabled]="isSubmitting">
                <span *ngIf="isSubmitting" class="spinner-border spinner-border-sm me-2"></span>
                Post Listing
            </button>
        </div>
    </form>
</div>