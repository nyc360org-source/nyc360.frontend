// --- Design Tokens ---
$bg-header: #fff0e6;      // ÿßŸÑÿÆŸÑŸÅŸäÿ© ÿßŸÑÿ®Ÿäÿ¨ ŸÑŸÑŸáŸäÿØÿ±
$primary-orange: #ff7f50; // ÿßŸÑÿ®ÿ±ÿ™ŸÇÿßŸÑŸä ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿä
$primary-hover: #e66a3c;
$success-green: #27ae60;  // ÿßŸÑÿ£ÿÆÿ∂ÿ± ŸÑÿ≠ÿßŸÑÿ© ÿßŸÑŸÜÿ¨ÿßÿ≠
$text-dark: #2c2c2c;
$text-gray: #666;
$white: #ffffff;
$radius: 16px;
$font-header: 'Merriweather', serif;
$font-body: 'Inter', sans-serif;

:host {
  display: block;
}

.discovery-page {
  font-family: $font-body;
  background-color: #f8f9fa;
  min-height: 100vh;
  padding-bottom: 60px;
}

/* --- Header Section --- */
.discovery-header {
  background-color: $bg-header;
  padding: 60px 20px;
  text-align: center;
  border-bottom: 1px solid rgba(0,0,0,0.05);

  h1 { 
    font-family: $font-header; 
    font-size: 2.5rem; 
    color: $primary-orange; 
    margin-bottom: 10px; 
    font-weight: 700; 
  }
  
  p { 
    color: #8c7b70; 
    font-size: 1.1rem; 
    margin-bottom: 40px; 
  }

  /* Filter Bar Styling */
  .filter-bar {
    max-width: 900px; 
    margin: 0 auto;
    background: $white; 
    padding: 10px; 
    border-radius: 50px;
    display: flex; 
    align-items: center; 
    gap: 10px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.05);
    position: relative;
    z-index: 10; // To ensure dropdown appears on top
    
    @media (max-width: 900px) { 
      flex-direction: column; 
      border-radius: 20px; 
      padding: 20px; 
    }

    /* Common Input Styles */
    .search-input, .type-select, .location-search {
      flex: 1; 
      display: flex; 
      align-items: center; 
      gap: 10px; 
      background: #f9f9f9; 
      padding: 12px 20px; 
      border-radius: 30px;
      
      i { color: $text-gray; font-size: 1.1rem; }
      
      input, select { 
        border: none; 
        background: transparent; 
        outline: none; 
        width: 100%; 
        font-size: 1rem; 
        color: $text-dark; 
      }
      
      @media (max-width: 900px) { width: 100%; }
    }

    /* Location Search Specifics */
    .location-search {
      position: relative;
      
      .clear-icon { 
        cursor: pointer; 
        color: $text-gray; 
        transition: 0.2s;
        &:hover { color: #e74c3c; } 
      }
      
      /* Dropdown Menu */
      .loc-dropdown {
        position: absolute; 
        top: 115%; 
        left: 0; 
        width: 100%; 
        background: $white;
        border-radius: 16px; 
        box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        z-index: 100; 
        max-height: 250px; 
        overflow-y: auto;
        padding: 5px 0;
        text-align: left;
        
        .loc-item {
          padding: 12px 20px; 
          border-bottom: 1px solid #f8f8f8; 
          cursor: pointer; 
          transition: background 0.2s;
          
          &:last-child { border-bottom: none; }
          &:hover { background: #fff0e6; }
          
          strong { display: block; font-size: 0.95rem; color: $text-dark; margin-bottom: 2px; }
          span { font-size: 0.8rem; color: $text-gray; }
        }

        // Scrollbar for dropdown
        &::-webkit-scrollbar { width: 6px; }
        &::-webkit-scrollbar-thumb { background: #ddd; border-radius: 3px; }
      }
    }

    .btn-search {
      background: $primary-orange; 
      color: white; 
      border: none; 
      padding: 12px 35px;
      border-radius: 30px; 
      font-weight: 600; 
      cursor: pointer; 
      transition: 0.2s;
      
      &:hover { background: $primary-hover; transform: translateY(-1px); }
      @media (max-width: 900px) { width: 100%; }
    }
  }
}

.container { 
  max-width: 1200px; 
  margin: 0 auto; 
  padding: 40px 20px; 
}

/* --- Grid Layout --- */
.comm-grid {
  display: grid; 
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); 
  gap: 30px;
  
  .comm-card {
    background: $white; 
    border-radius: $radius; 
    overflow: hidden;
    box-shadow: 0 4px 15px rgba(0,0,0,0.03); 
    transition: 0.3s;
    display: flex; 
    flex-direction: column; 
    height: 100%;
    border: 1px solid transparent;

    &:hover { 
      transform: translateY(-5px); 
      box-shadow: 0 10px 25px rgba(0,0,0,0.08); 
      border-color: rgba($primary-orange, 0.2);
    }

    .card-head {
      height: 160px; 
      background: #eee; 
      position: relative;
      display: flex; 
      align-items: center; 
      justify-content: center;
      overflow: hidden;
      
      .comm-img { 
        width: 100%; 
        height: 100%; 
        object-fit: cover; 
        cursor: pointer; 
        transition: transform 0.5s; 
      }
      &:hover .comm-img { transform: scale(1.05); }

      .badges { position: absolute; top: 15px; right: 15px; z-index: 2; }
      .type-badge { 
        background: rgba(0,0,0,0.7); 
        color: white; 
        font-size: 0.75rem; 
        padding: 4px 12px; 
        border-radius: 20px; 
        backdrop-filter: blur(4px); 
        font-weight: 600; 
      }
    }

    .card-body {
      padding: 25px; 
      flex: 1; 
      display: flex; 
      flex-direction: column;
      
      h3 { 
        font-family: $font-header; 
        font-size: 1.3rem; 
        color: $text-dark; 
        margin: 0 0 10px 0; 
        cursor: pointer; 
        font-weight: 700; 
        line-height: 1.3; 
        
        &:hover { color: $primary-orange; } 
      }
      
      .desc { 
        font-size: 0.95rem; 
        color: $text-gray; 
        line-height: 1.5; 
        margin-bottom: 20px; 
        flex: 1; 
      }
      
      .meta {
        display: flex; 
        justify-content: space-between; 
        font-size: 0.85rem; 
        color: #888; 
        margin-bottom: 20px; 
        border-top: 1px solid #f5f5f5; 
        padding-top: 15px;
        
        i { margin-right: 5px; color: $primary-orange; }
        .private i { color: #e74c3c; } 
        .public i { color: $success-green; }
      }

      .btn-join {
        width: 100%; 
        padding: 12px; 
        border: 1px solid $primary-orange; 
        background: white;
        color: $primary-orange; 
        border-radius: 30px; 
        font-weight: 600; 
        cursor: pointer; 
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        
        &:hover:not(:disabled) { 
          background: $primary-orange; 
          color: white; 
        }
        
        &.joined { 
          background: transparent; 
          border-color: $success-green; 
          color: $success-green; 
          cursor: default; 
        }

        // üî• New: Success State (Green Background)
        &.success-state {
          background-color: $success-green !important;
          border-color: $success-green !important;
          color: white !important;
          cursor: default;
          transform: none !important;
          box-shadow: none !important;
          
          i { font-size: 1.1rem; }
        }

        &:disabled { 
          opacity: 0.7; 
          cursor: not-allowed; 
        }
      }
    }
  }
}

/* --- Pagination --- */
.pagination {
  display: flex; 
  justify-content: center; 
  align-items: center; 
  gap: 20px; 
  margin-top: 50px;
  
  button {
    background: white; 
    border: 1px solid #eee; 
    padding: 10px 20px; 
    border-radius: 30px; 
    cursor: pointer; 
    font-weight: 600; 
    color: $text-dark; 
    transition: 0.2s;
    display: flex;
    align-items: center;
    gap: 5px;
    
    &:hover:not(:disabled) { 
      border-color: $primary-orange; 
      color: $primary-orange; 
      background: #fff0e6;
    }
    
    &:disabled { 
      opacity: 0.5; 
      cursor: not-allowed; 
      color: #ccc; 
      background: #f9f9f9;
    }
  }
  
  .page-info { 
    color: $text-gray; 
    font-weight: 500; 
    font-size: 0.95rem;
  }
}

/* --- Empty State --- */
.empty-state { 
  text-align: center; 
  padding: 80px 0; 
  
  i { 
    font-size: 3rem; 
    color: #ddd; 
    margin-bottom: 15px; 
    display: block; 
  }
  
  h3 { margin-bottom: 10px; color: $text-dark; }
  p { color: $text-gray; }
}