<div class="tag-page-container">
  
  <div class="layout-grid">
    
    <main class="main-content">
      
      <header class="tag-header">
        <div class="icon-wrapper">
          <i class="bi bi-hash"></i>
        </div>
        <div class="info-wrapper">
          <h1>{{ displayTagName }}</h1>
          <p *ngIf="isLoaded">{{ totalCount }} posts found</p>
        </div>
      </header>

      <div class="posts-grid" *ngIf="posts.length > 0">
        <div class="post-card" *ngFor="let post of posts" [routerLink]="['/public/posts/details', post.id]">
          <div class="card-img">
            <img [src]="resolvePostImage(post)" loading="lazy" alt="Post Image">
            <span class="category-badge">{{ getCategoryName(post.category) }}</span>
          </div>
          
          <div class="card-body">
            <h2 class="title">{{ post.title }}</h2>
            <p class="excerpt">{{ post.content | slice:0:110 }}...</p>
            
            <div class="meta">
              <div class="author">
                <i class="bi bi-person-fill"></i>
                <span>{{ getAuthorName(post.author) }}</span>
              </div>
              <span class="date">{{ post.createdAt | date:'MMM d' }}</span>
            </div>
            
            <div class="mini-tags" *ngIf="post.tags && post.tags.length > 0">
               <span *ngFor="let t of post.tags | slice:0:2">#{{ t }}</span>
            </div>
          </div>
        </div>
      </div>

      <div *ngIf="isLoaded && posts.length === 0" class="state-container empty">
        <div class="empty-icon"><i class="bi bi-search"></i></div>
        <h3>No results found</h3>
        <p>We couldn't find any posts tagged with <strong>#{{ tagName }}</strong>.</p>
        <button class="btn-back" routerLink="/public/home">Go Back Home</button>
      </div>

    </main>

    <aside class="sidebar">
      <div class="widget" *ngIf="relatedTags.length > 0">
        <h3><i class="bi bi-tags-fill"></i> Related Topics</h3>
        <p class="subtitle">Tags found in these posts</p>
        
        <div class="tags-cloud">
          <a *ngFor="let tag of relatedTags; let i = index" 
             [routerLink]="['/public/posts/tags', tag]" 
             class="tag-pill"
             [ngClass]="['c1', 'c2', 'c3', 'c4', 'c5'][i % 5]">
             {{ tag }}
          </a>
        </div>
      </div>

      <div class="widget ad-space">
        <span>Advertisement</span>
      </div>
    </aside>

  </div>
</div>